# ğŸ¯ å¤¹çˆªçŠ¶æ€ä¿æŒåŠŸèƒ½è¯´æ˜

## ğŸ“‹ é—®é¢˜æè¿°

ä¹‹å‰çš„é—®é¢˜ï¼š**æœºæ¢°è‡‚ç§»åŠ¨æˆ–æ—‹è½¬æ—¶ï¼Œå¤¹çˆªä¼šè¢«å¼ºåˆ¶æ”¹å˜çŠ¶æ€**

ä¾‹å¦‚ï¼š
- å¤¹çˆªé—­åˆåˆ°æŸä¸ªä½ç½®
- ç„¶åæ—‹è½¬æœºæ¢°è‡‚
- å¤¹çˆªè¢«å¼ºåˆ¶æ‰“å¼€æˆ–æ”¹å˜ä½ç½® âŒ

## âœ… è§£å†³æ–¹æ¡ˆ

### æ ¸å¿ƒæ”¹è¿›

æ·»åŠ äº† **`control_gripper`** å‚æ•°ï¼Œè®©ä½ å¯ä»¥é€‰æ‹©ï¼š
1. **æ§åˆ¶å¤¹çˆª** - æ˜ç¡®æ”¹å˜å¤¹çˆªä½ç½®
2. **ä¿æŒå¤¹çˆª** - æœºæ¢°è‡‚ç§»åŠ¨æ—¶ï¼Œå¤¹çˆªä¿æŒå½“å‰çŠ¶æ€

### ä»£ç æ”¹è¿›

#### 1. æ”¹è¿›çš„ `control_arm()` å‡½æ•°

```python
def control_arm(piper, joints, speed=20, control_gripper=True):
    """æ§åˆ¶æœºæ¢°è‡‚è¿åŠ¨
    Args:
        control_gripper: True=æ§åˆ¶å¤¹çˆª, False=ä¿æŒå¤¹çˆªå½“å‰çŠ¶æ€
    """
    # ...æœºæ¢°è‡‚æ§åˆ¶ä»£ç ...
    
    # åªæœ‰æ˜ç¡®è¦æ±‚æ§åˆ¶å¤¹çˆªæ—¶æ‰å‘é€å¤¹çˆªå‘½ä»¤
    if control_gripper and len(joints) > 6:
        joint_6 = round(position[6] * 1000 * 1000)
        piper.GripperCtrl(abs(joint_6), 1000, 0x01, 0)
        current_gripper_position = position[6]  # è®°å½•å½“å‰å¤¹çˆªä½ç½®
```

**å…³é”®ç‚¹ï¼š**
- `control_gripper=True` - ä¼šæ§åˆ¶å¤¹çˆªåˆ° `joints[6]` æŒ‡å®šçš„ä½ç½®
- `control_gripper=False` - å®Œå…¨ä¸å‘é€å¤¹çˆªå‘½ä»¤ï¼Œä¿æŒå½“å‰çŠ¶æ€

#### 2. æ–°å¢ `set_gripper()` å‡½æ•°

```python
def set_gripper(piper, position):
    """å•ç‹¬è®¾ç½®å¤¹çˆªä½ç½®
    Args:
        position: å¤¹çˆªä½ç½® (å•ä½:ç±³) 0.00-0.07
    """
    if 0 <= position <= 0.07:
        joint_6 = round(position * 1000 * 1000)
        piper.GripperCtrl(abs(joint_6), 1000, 0x01, 0)
        current_gripper_position = position
        print(f"å¤¹çˆªè®¾ç½®åˆ° {position*1000:.1f}mm")
```

**ç”¨é€”ï¼š**
- å•ç‹¬æ§åˆ¶å¤¹çˆª
- ä¸å½±å“æœºæ¢°è‡‚ä½ç½®
- æ˜ç¡®çŸ¥é“å¤¹çˆªåœ¨åšä»€ä¹ˆ

#### 3. å…¨å±€å¤¹çˆªä½ç½®è·Ÿè¸ª

```python
# å…¨å±€å˜é‡ï¼šè®°å½•å½“å‰å¤¹çˆªçŠ¶æ€
current_gripper_position = None  # Noneè¡¨ç¤ºæœªåˆå§‹åŒ–

def get_gripper_position():
    """è·å–å½“å‰å¤¹çˆªä½ç½®"""
    global current_gripper_position
    return current_gripper_position
```

**å¥½å¤„ï¼š**
- éšæ—¶çŸ¥é“å¤¹çˆªå½“å‰ä½ç½®
- ä¾¿äºè°ƒè¯•å’Œç”¨æˆ·æŸ¥çœ‹
- ç¡®ä¿çŠ¶æ€ä¸€è‡´æ€§

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šåŠ¨ä½œ1 - æ—‹è½¬æ—¶ä¿æŒå¤¹çˆªçŠ¶æ€

```python
def action1_rotate_gripper(piper, rotation_angle, direction):
    """åŠ¨ä½œ1: æ§åˆ¶å¤¹çˆªæ—‹è½¬ï¼ˆå¤¹çˆªä¿æŒå½“å‰çŠ¶æ€ï¼‰"""
    
    # ç§»åŠ¨åˆ°å‡†å¤‡å§¿æ€ï¼ˆå¤¹çˆªä¿æŒå½“å‰çŠ¶æ€ï¼‰
    go_to_ready_pose(piper, gripper_position=None)  # None = ä¿æŒ
    
    # æ—‹è½¬å¤¹çˆªï¼ˆä¿æŒå¤¹çˆªå¼€åˆçŠ¶æ€ï¼‰
    joints = [0, -0.5, -0.8, 0, -0.5, 0]
    joints[5] = actual_angle
    control_arm(piper, joints, 20, control_gripper=False)  # âœ“ ä¸æ§åˆ¶å¤¹çˆª
    
    # æ—‹è½¬å›æ¥ï¼ˆä¿æŒå¤¹çˆªå¼€åˆçŠ¶æ€ï¼‰
    joints[5] = 0
    control_arm(piper, joints, 20, control_gripper=False)  # âœ“ ä¸æ§åˆ¶å¤¹çˆª
```

**æ•ˆæœï¼š**
- æœºæ¢°è‡‚æ—‹è½¬
- å¤¹çˆªä¿æŒåŸæ¥çš„å¼€åˆçŠ¶æ€ï¼ˆæ— è®ºæ˜¯é—­åˆè¿˜æ˜¯æ‰“å¼€ï¼‰

### ç¤ºä¾‹2ï¼šåŠ¨ä½œ3 - é—­åˆåå‰åç§»åŠ¨

```python
def action3_close_move_back_forth(piper, move_distance):
    """åŠ¨ä½œ3: å¤¹çˆªé—­åˆåå‰åç§»åŠ¨ï¼ˆå¤¹çˆªä¿æŒé—­åˆçŠ¶æ€ï¼‰"""
    
    # é—­åˆå¤¹çˆª
    set_gripper(piper, 0.02)  # å•ç‹¬æ§åˆ¶å¤¹çˆªé—­åˆ
    
    # å‘åç§»åŠ¨ï¼ˆå¤¹çˆªä¿æŒé—­åˆï¼ï¼‰
    joints[2] += move_distance * 2
    control_arm(piper, joints, 20, control_gripper=False)  # âœ“ ä¸æ”¹å˜å¤¹çˆª
    
    # å†å‘å‰ç§»åŠ¨ï¼ˆå¤¹çˆªä¿æŒé—­åˆï¼ï¼‰
    joints[2] -= move_distance * 2
    control_arm(piper, joints, 20, control_gripper=False)  # âœ“ ä¸æ”¹å˜å¤¹çˆª
```

**æ•ˆæœï¼š**
- å¤¹çˆªé—­åˆå
- æœºæ¢°è‡‚å‰åç§»åŠ¨
- å¤¹çˆªå§‹ç»ˆä¿æŒé—­åˆçŠ¶æ€ âœ“

### ç¤ºä¾‹3ï¼šæ‰‹åŠ¨æµ‹è¯•

æ–°å¢äº†æµ‹è¯•åŠŸèƒ½ï¼ˆé€‰é¡¹5ï¼‰ï¼š

```
1. å…ˆè®¾ç½®å¤¹çˆªåˆ°æŸä¸ªä½ç½®ï¼ˆä¾‹å¦‚ 35mmï¼‰
2. ç§»åŠ¨æœºæ¢°è‡‚åˆ°å‡†å¤‡å§¿æ€
3. å›åˆ°é›¶ä½
4. è§‚å¯Ÿï¼šå¤¹çˆªåº”è¯¥å§‹ç»ˆä¿æŒåœ¨ 35mmï¼
```

## ğŸ“Š å‡½æ•°å‚æ•°å¯¹æ¯”

### `control_arm()` å‚æ•°

| å‚æ•° | å€¼ | æ•ˆæœ |
|------|---|------|
| `control_gripper` | `True` | æ§åˆ¶å¤¹çˆªåˆ° `joints[6]` ä½ç½® |
| `control_gripper` | `False` | **ä¸å‘é€å¤¹çˆªå‘½ä»¤ï¼Œä¿æŒå½“å‰çŠ¶æ€** â­ |

### `go_to_ready_pose()` å‚æ•°

| å‚æ•° | å€¼ | æ•ˆæœ |
|------|---|------|
| `gripper_position` | `0.00-0.07` | æ§åˆ¶å¤¹çˆªåˆ°æŒ‡å®šä½ç½® |
| `gripper_position` | `None` | **ä¿æŒå¤¹çˆªå½“å‰çŠ¶æ€** â­ |

### `go_to_zero()` å‚æ•°

| å‚æ•° | å€¼ | æ•ˆæœ |
|------|---|------|
| `close_gripper` | `True` | å›é›¶ä½æ—¶é—­åˆå¤¹çˆª |
| `close_gripper` | `False` | **å›é›¶ä½æ—¶ä¿æŒå¤¹çˆªçŠ¶æ€** â­ |

## ğŸ” å·¥ä½œåŸç†

### çŠ¶æ€ä¿æŒçš„å…³é”®

```python
# âŒ åŸæ¥çš„ä»£ç  - æ€»æ˜¯å‘é€å¤¹çˆªå‘½ä»¤
if len(joints) > 6:
    piper.GripperCtrl(...)  # æ¯æ¬¡éƒ½å‘é€

# âœ… æ”¹è¿›åçš„ä»£ç  - å¯é€‰æ‹©æ˜¯å¦å‘é€
if control_gripper and len(joints) > 6:
    piper.GripperCtrl(...)  # åªåœ¨éœ€è¦æ—¶å‘é€
```

**åŸç†ï¼š**
- å¤¹çˆªç¡¬ä»¶ä¼šä¿æŒæœ€åæ”¶åˆ°çš„å‘½ä»¤
- å¦‚æœä¸å‘é€æ–°å‘½ä»¤ï¼Œå¤¹çˆªå°±ä¿æŒåŸçŠ¶æ€
- `control_gripper=False` å°±æ˜¯ä¸å‘é€å‘½ä»¤

### ä¸¤ç§æ§åˆ¶æ–¹å¼å¯¹æ¯”

#### æ–¹å¼1ï¼šæœºæ¢°è‡‚å’Œå¤¹çˆªä¸€èµ·æ§åˆ¶

```python
# åŒæ—¶æ§åˆ¶æœºæ¢°è‡‚å’Œå¤¹çˆª
joints = [0, -0.5, -0.8, 0, -0.5, 0, 0.02]
control_arm(piper, joints, 20, control_gripper=True)
```

#### æ–¹å¼2ï¼šåˆ†ç¦»æ§åˆ¶

```python
# å…ˆæ§åˆ¶å¤¹çˆª
set_gripper(piper, 0.02)

# å†æ§åˆ¶æœºæ¢°è‡‚ï¼ˆä¸æ”¹å˜å¤¹çˆªï¼‰
joints = [0, -0.5, -0.8, 0, -0.5, 0]
control_arm(piper, joints, 20, control_gripper=False)
```

**æ¨èï¼š**
- éœ€è¦åŒæ—¶æ”¹å˜æ—¶ç”¨æ–¹å¼1
- éœ€è¦ä¿æŒå¤¹çˆªæ—¶ç”¨æ–¹å¼2

## ğŸ® æ–°å¢åŠŸèƒ½

### 1. å®æ—¶æ˜¾ç¤ºå¤¹çˆªä½ç½®

ä¸»èœå•ä¼šæ˜¾ç¤ºï¼š
```
å½“å‰å¤¹çˆªä½ç½®: 35.0mm
è¯·é€‰æ‹©åŠ¨ä½œ:
...
```

### 2. æµ‹è¯•åŠŸèƒ½ï¼ˆé€‰é¡¹5ï¼‰

ä¸“é—¨ç”¨äºæµ‹è¯•å¤¹çˆªçŠ¶æ€ä¿æŒåŠŸèƒ½ï¼š
```
æµ‹è¯•ï¼šç§»åŠ¨æœºæ¢°è‡‚ä½†ä¿æŒå¤¹çˆªçŠ¶æ€
1. å…ˆè®¾ç½®å¤¹çˆªåˆ°æŸä¸ªä½ç½®
2. ç„¶åç§»åŠ¨æœºæ¢°è‡‚
3. è§‚å¯Ÿå¤¹çˆªæ˜¯å¦ä¿æŒä¸å˜
```

### 3. çµæ´»çš„å›é›¶ä½é€‰é¡¹

ç°åœ¨è¯¢é—®ï¼š
- æ˜¯å¦å›é›¶ä½ï¼Ÿ
- å›é›¶æ—¶æ˜¯å¦é—­åˆå¤¹çˆªï¼Ÿ

ç”¨æˆ·å¯ä»¥è‡ªç”±é€‰æ‹©ï¼

## ğŸ“ ä½¿ç”¨å»ºè®®

### ä»€ä¹ˆæ—¶å€™ç”¨ `control_gripper=False`ï¼Ÿ

âœ… **åº”è¯¥ä½¿ç”¨çš„åœºæ™¯ï¼š**
1. æ—‹è½¬æœºæ¢°è‡‚æ—¶
2. ç§»åŠ¨æœºæ¢°è‡‚åˆ°æ–°ä½ç½®æ—¶
3. è°ƒæ•´æœºæ¢°è‡‚å§¿æ€æ—¶
4. ä»»ä½•ä¸éœ€è¦æ”¹å˜å¤¹çˆªçš„åŠ¨ä½œ

âŒ **ä¸åº”è¯¥ä½¿ç”¨çš„åœºæ™¯ï¼š**
1. æ˜ç¡®è¦æ‰“å¼€æˆ–é—­åˆå¤¹çˆªæ—¶
2. éœ€è¦è°ƒæ•´å¤¹çˆªå¼€åˆåº¦æ—¶
3. åˆå§‹åŒ–æ—¶è®¾ç½®å¤¹çˆªçŠ¶æ€

### æœ€ä½³å®è·µ

```python
# 1. åˆå§‹åŒ–ï¼šè®¾ç½®å¤¹çˆªåˆ°æœŸæœ›ä½ç½®
set_gripper(piper, 0.07)  # æ‰“å¼€

# 2. ç§»åŠ¨æœºæ¢°è‡‚ï¼šä¿æŒå¤¹çˆªçŠ¶æ€
control_arm(piper, joints, 20, control_gripper=False)

# 3. åˆ°è¾¾ç›®æ ‡åï¼šæ”¹å˜å¤¹çˆªçŠ¶æ€
set_gripper(piper, 0.02)  # é—­åˆ

# 4. ç§»åŠ¨å›æ¥ï¼šä¿æŒå¤¹çˆªé—­åˆ
control_arm(piper, joints2, 20, control_gripper=False)

# 5. æœ€åï¼šæ‰“å¼€å¤¹çˆªé‡Šæ”¾
set_gripper(piper, 0.07)
```

## ğŸ†š ä¿®å¤å‰åå¯¹æ¯”

### ä¿®å¤å‰ âŒ

```python
# åŠ¨ä½œ1ï¼šæ—‹è½¬å¤¹çˆª
go_to_ready_pose(piper, gripper_position=0.07)  # å¼ºåˆ¶æ‰“å¼€
joints = [0, -0.5, -0.8, 0, -0.5, 0, 0.07]
joints[5] = angle
control_arm(piper, joints, 20)  # ä»ç„¶å‘é€0.07

# é—®é¢˜ï¼šå³ä½¿å¤¹çˆªæœ¬æ¥æ˜¯é—­åˆçš„ï¼Œä¹Ÿè¢«å¼ºåˆ¶æ‰“å¼€äº†ï¼
```

### ä¿®å¤å âœ…

```python
# åŠ¨ä½œ1ï¼šæ—‹è½¬å¤¹çˆª
go_to_ready_pose(piper, gripper_position=None)  # ä¿æŒå½“å‰
joints = [0, -0.5, -0.8, 0, -0.5, 0]
joints[5] = angle
control_arm(piper, joints, 20, control_gripper=False)  # ä¸å‘é€å¤¹çˆªå‘½ä»¤

# æ•ˆæœï¼šå¤¹çˆªä¿æŒåŸçŠ¶æ€ï¼Œæ— è®ºæ˜¯é—­åˆè¿˜æ˜¯æ‰“å¼€ï¼
```

## ğŸ‰ æ€»ç»“

### å…³é”®æ”¹è¿›

1. âœ… æ·»åŠ  `control_gripper` å‚æ•°æ§åˆ¶æ˜¯å¦å‘é€å¤¹çˆªå‘½ä»¤
2. âœ… æ–°å¢ `set_gripper()` å‡½æ•°å•ç‹¬æ§åˆ¶å¤¹çˆª
3. âœ… å…¨å±€å˜é‡è·Ÿè¸ªå¤¹çˆªå½“å‰ä½ç½®
4. âœ… æ‰€æœ‰å‡½æ•°æ”¯æŒä¿æŒå¤¹çˆªçŠ¶æ€çš„é€‰é¡¹
5. âœ… æ–°å¢æµ‹è¯•åŠŸèƒ½éªŒè¯çŠ¶æ€ä¿æŒ

### ä½¿ç”¨æ–¹æ³•

```python
# ä¿æŒå¤¹çˆªçŠ¶æ€ï¼š
control_arm(piper, joints, speed, control_gripper=False)
go_to_ready_pose(piper, gripper_position=None)
go_to_zero(piper, close_gripper=False)

# æ”¹å˜å¤¹çˆªçŠ¶æ€ï¼š
set_gripper(piper, 0.02)  # å•ç‹¬æ§åˆ¶
control_arm(piper, joints_with_gripper, speed, control_gripper=True)
```

**ç°åœ¨æœºæ¢°è‡‚ç§»åŠ¨æ—¶ï¼Œå¤¹çˆªä¼šä¿æŒå½“å‰çŠ¶æ€äº†ï¼** ğŸ‰
